#' @title filters the current food storage
#' @description This function filters the current food storage. It looks for 
#' the last storage's change for each product and filters them. Optionally
#' one can give a \code{group} as input, which is a character strings 
#' containing product names. If this is given, the function will filter
#' the dataset by these product names.
#' @param dataset kornumsatz as a result from \code{startupSettings()}
#' @param group optional character vector which contians product names
#' @return A dataframe will be returned.
#' @export
#' @importFrom magrittr '%>%'

currentStorage <- function(dataset, group) {
  
  
  if (!missing(group)) {
    stopifnot(is.character(group))
    
    data <- dataset %>%
      dplyr::filter(Produkt_Zusammenfassung %in% group) %>%
      dplyr::group_by(Produkt_Zusammenfassung) %>%
      dplyr::filter(Tag == last(Tag)) %>%
      dplyr::ungroup() 
    
  } else {
    data <- dataset %>%
      dplyr::group_by(Produkt_Zusammenfassung) %>%
      dplyr::filter(Tag == dplyr::last(Tag)) %>%
      dplyr::ungroup()
  }
  
  return(data)
  
}